# Tasks: imrbs 會議室預約系統

**Input**: Implementation plan from `/specs/1-imrbs-app/`

## 格式說明：
- [P]: 可平行執行的任務（不同檔案、無相依性）
- [Story X]: 對應使用者故事（US1、US2 等）

## Phase 1: 設置階段（共用基礎建設）

**目的**: 建立專案結構與共用框架

1. 專案基礎建設
- [x] T001 建立 Maven 多模組結構：imrbs-core 與 imrbs-web
- [x] T002 [P] 設定 Spring Boot 3.2.x 與相依套件
- [ ] T003 [P] 設定 Vue 3 專案結構與建置工具
- [ ] T004 [P] 配置 ESLint 與程式碼風格規則

2. 測試基礎建設
- [ ] T005 [P] 設定後端測試框架 (JUnit 5 + Mockito)
- [ ] T006 [P] 設定前端測試框架 (Vitest + Vue Test Utils)
- [ ] T007 [P] 設定 E2E 測試環境 (Cypress)

3. 共用基礎設施
- [ ] T008 建立 JSON 儲存服務與檔案操作工具
- [ ] T009 實作檔案監控與鎖定機制
- [ ] T010 [P] 建立郵件服務介面與測試替身

**檢查點**: 基礎建設完成，可開始實作功能

## Phase 2: User Story 1 - 建立預約 (P1)

### 後端測試
- [ ] T011 [P] [US1] 單元測試：`RoomService` 在 `imrbs-core/tests/unit/`
- [ ] T012 [P] [US1] 單元測試：`ReservationService` 在 `imrbs-core/tests/unit/`
- [ ] T013 [US1] 整合測試：預約建立流程 在 `imrbs-web/tests/integration/`

### 核心實作
- [ ] T014 [P] [US1] 實作 `Room` 實體與 DTO 在 `imrbs-core/model/`
- [ ] T015 [P] [US1] 實作 `Reservation` 實體與 DTO 在 `imrbs-core/model/`
- [ ] T016 [US1] 實作 `RoomService` 讀取與快取邏輯
- [ ] T017 [US1] 實作 `ReservationService` 建立與衝突檢查
- [ ] T018 [US1] 實作 `EmailService` 預約通知功能

### API 實作
- [ ] T019 [US1] 實作 `RoomController` REST endpoints
- [ ] T020 [US1] 實作 `ReservationController` REST endpoints
- [ ] T021 [US1] 實作輸入驗證與錯誤處理

### 前端測試
- [ ] T022 [P] [US1] 單元測試：會議室選擇元件
- [ ] T023 [P] [US1] 單元測試：預約表單元件
- [ ] T024 [US1] E2E測試：完整預約流程

### 前端實作
- [ ] T025 [P] [US1] 實作會議室選擇元件
- [ ] T026 [P] [US1] 實作日期時間選擇元件
- [ ] T027 [US1] 實作預約表單元件
- [ ] T028 [US1] 實作 API 整合服務
- [ ] T029 [US1] 實作錯誤處理與使用者提示

**檢查點**: 使用者可完整執行預約流程

## Phase 3: User Story 2 - 修改/取消預約 (P1)

### 後端測試
- [ ] T030 [P] [US2] 單元測試：預約修改邏輯
- [ ] T031 [P] [US2] 單元測試：預約取消邏輯
- [ ] T032 [US2] 整合測試：修改與取消流程

### 核心實作
- [ ] T033 [US2] 擴充 `ReservationService` 修改功能
- [ ] T034 [US2] 擴充 `ReservationService` 取消功能
- [ ] T035 [US2] 實作修改/取消郵件通知

### 前端測試
- [ ] T036 [P] [US2] 單元測試：預約管理元件
- [ ] T037 [US2] E2E測試：修改與取消流程

### 前端實作
- [ ] T038 [P] [US2] 實作預約清單與詳情視圖
- [ ] T039 [US2] 實作修改表單元件
- [ ] T040 [US2] 實作取消確認流程
- [ ] T041 [US2] 整合 API 與錯誤處理

**檢查點**: 使用者可修改與取消預約

## Phase 4: User Story 3 - 會議室清單與狀態 (P1)

### 後端測試
- [ ] T042 [P] [US3] 單元測試：會議室狀態查詢
- [ ] T043 [US3] 整合測試：清單與狀態 API

### 核心實作
- [ ] T044 [US3] 實作會議室狀態查詢邏輯
- [ ] T045 [US3] 實作即時更新 WebSocket 服務

### 前端測試
- [ ] T046 [P] [US3] 單元測試：會議室清單元件
- [ ] T047 [P] [US3] 單元測試：即時更新整合
- [ ] T048 [US3] E2E測試：狀態顯示功能

### 前端實作
- [ ] T049 [P] [US3] 實作會議室清單與篩選
- [ ] T050 [P] [US3] 實作狀態顯示元件
- [ ] T051 [US3] 實作即時更新訂閱
- [ ] T052 [US3] 實作視覺化時段顯示

**檢查點**: 使用者可查看會議室狀態與即時更新

## Phase 5: User Story 4 - 會議室管理 (P2)

### 後端測試
- [ ] T053 [P] [US4] 單元測試：會議室管理功能
- [ ] T054 [US4] 整合測試：管理 API 端點

### 核心實作
- [ ] T055 [US4] 實作會議室 CRUD 操作
- [ ] T056 [US4] 實作管理員權限檢查

### 前端測試
- [ ] T057 [P] [US4] 單元測試：管理介面元件
- [ ] T058 [US4] E2E測試：管理功能流程

### 前端實作
- [ ] T059 [P] [US4] 實作會議室管理介面
- [ ] T060 [US4] 實作編輯表單元件
- [ ] T061 [US4] 整合管理 API

**檢查點**: 管理員可管理會議室資訊

## Phase 6: 效能與品質提升

1. 效能優化
- [ ] T062 [P] 實作會議室資料快取機制
- [ ] T063 [P] 優化衝突檢查演算法
- [ ] T064 [P] 前端資料快取與預取

2. 可靠性提升
- [ ] T065 實作 JSON 檔案備份機制
- [ ] T066 實作資料一致性檢查工具
- [ ] T067 [P] 加強錯誤處理與恢復機制

3. 監控與維護
- [ ] T068 [P] 實作操作日誌記錄
- [ ] T069 [P] 建立系統健康檢查端點
- [ ] T070 補充技術文件

## 相依性與執行順序

### 階段相依
- Phase 1 (設置) 必須先完成
- User Stories 可平行開發，但建議依優先順序：
  1. 建立預約 (P1)
  2. 修改/取消預約 (P1)
  3. 清單與狀態 (P1)
  4. 會議室管理 (P2)

### 開發建議順序
1. 基礎建設：T001-T010
2. 核心功能：依照 User Story 優先順序
3. 效能優化：完成功能後進行

### 平行開發機會
- 前後端可同時開發（API 契約定義後）
- 單元測試可與實作同時進行
- 標記 [P] 的任務可平行執行

## 實作策略

### 漸進式交付
1. 先完成 MVP：
   - 基本預約功能
   - 簡單的清單顯示
   - 必要的修改/取消功能

2. 再加入進階功能：
   - 即時更新
   - 管理功能
   - 效能優化

### 測試策略
- 單元測試必須先寫
- 整合測試跟隨功能開發
- E2E 測試在功能完成後進行

### 團隊分工建議
- 後端開發者：核心邏輯與 API
- 前端開發者：UI 元件與整合
- 測試者：E2E 測試與品質把關